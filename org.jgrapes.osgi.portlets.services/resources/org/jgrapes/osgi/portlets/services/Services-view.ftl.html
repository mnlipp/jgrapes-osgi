<div data-portlet-title="${_("portletName")}" class="jgrapes-osgi-services-view">
  <div class="jgrapes-osgi-services-view-search">
    <form>
      <span class="jgportal-input-group">
        <span class="jgportal-item jgportal-input-label">${_("Filter")}</span>
        <span class="jgportal-item">
          <input type="search" v-on:input="controller.updateFilter($event)">
        </span>
        <span class="jgportal-item">
          <span role="button" class="jgportal-button-icon fas fa-backspace" 
            v-on:click="controller.clearFilter($event)"></span>
        </span>
      </span>
    </form>
  </div>
  <table class="jgportal-basic-table jgportal-striped-table jgrapes-osgi-services-view-table">
    <thead>
      <tr>
        <th v-for="key in controller.keys"
          v-on:click="controller.sortBy(key)">
          {{ controller.label(key) }}<span v-if="controller.sortedByAsc(key)"
            role="button" class="jgportal-button-icon">&#x25B2;</span><span
            v-if="controller.sortedByDesc(key)"
            role="button" class="jgportal-button-icon">&#x25BC;</span>
        </th>
      </tr>
    </thead>
    <tbody>
      <template v-for="(entry, rowIndex) in filteredData">
        <tr :class="[(rowIndex % 2) ? 'odd' : 'even']">
          <td v-for="key in controller.keys"
            v-bind:rowspan="key == 'id' && detailsFor.has(entry.id) ? '2' : false">
            <span v-if="key == 'id'"
              role="button" class="jgportal-button-icon fas"
              v-bind:class="[detailsFor.has(entry.id) ? 'fa-caret-down' : 'fa-caret-right']"
              v-on:click="toggleDetails(entry.id)"></span>
            <span v-html="controller.breakBeforeDots(entry[key])"></span>
          </td>
        </tr>
        <template v-if="detailsFor.has(entry.id)">
          <tr :class="[(rowIndex % 2) ? 'odd' : 'even']">
            <td colspan="4" class="details">
              <table class="jgportal-auto-striped-table">
                <tr v-for="[key, value] of sortedProperties(entry.properties)">
                  <td>{{ key }}</td>
                  <td>{{ value }}</td>
                </tr>
                <tr v-if="entry.usingBundles && entry.usingBundles.length > 0">
                  <td>{{ orgJGrapesOsgiPortletsServices.l10n.serviceUsingBundles }}</td>
                  <td>{{ entry.usingBundles.join(", ") }}</td>
                </tr>
              </table>
            </td>
          </tr>
        </template>
      </template>
    </tbody>
  </table>
</div>

<script>
	orgJGrapesOsgiPortletsServices.initViewTable("${portlet.portletId}");
</script>
